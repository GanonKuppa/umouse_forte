   1                             		.file	"timer.cpp"
   2                             		.section P,"ax"
   3                             	.Ltext0:
   4                             		.global	__Z8initTPU0v
   6                             	__Z8initTPU0v:
   7                             	.LFB0:
   8                             		.file 1 "../src/peripheral/timer.cpp"
   1:../src/peripheral/timer.cpp **** /*
   2:../src/peripheral/timer.cpp ****  * timer.cpp
   3:../src/peripheral/timer.cpp ****  *
   4:../src/peripheral/timer.cpp ****  *  Created on: 2016/08/15
   5:../src/peripheral/timer.cpp ****  *      Author: ryota
   6:../src/peripheral/timer.cpp ****  */
   7:../src/peripheral/timer.cpp **** 
   8:../src/peripheral/timer.cpp **** #include <stdint.h>
   9:../src/peripheral/timer.cpp **** 
  10:../src/peripheral/timer.cpp **** #include <timer.h>
  11:../src/peripheral/timer.cpp **** #include "iodefine.h"
  12:../src/peripheral/timer.cpp **** #include "clock.h"
  13:../src/peripheral/timer.cpp **** #include "uart.hpp"
  14:../src/peripheral/timer.cpp **** //タイマを三つ使用
  15:../src/peripheral/timer.cpp **** //CMTW0 elepsedTimeを刻む
  16:../src/peripheral/timer.cpp **** //CMTW1 メインのタイマに使用
  17:../src/peripheral/timer.cpp **** //TPU0  サブのタイマに使用
  18:../src/peripheral/timer.cpp **** 
  19:../src/peripheral/timer.cpp **** 
  20:../src/peripheral/timer.cpp **** 
  21:../src/peripheral/timer.cpp **** // PCLKBがクロックソース48MHz かつ タイマの分周比=8 --> 1μ秒　＝　6 カウン
  22:../src/peripheral/timer.cpp **** static const unsigned int u_count = 6;
  23:../src/peripheral/timer.cpp **** static const unsigned int m_count = 6000;
  24:../src/peripheral/timer.cpp **** 
  25:../src/peripheral/timer.cpp **** void initTPU0(){
   9                             		.loc 1 25 0
  26:../src/peripheral/timer.cpp **** 	SYSTEM.PRCR.WORD = 0xA502;
  10                             		.loc 1 26 0
  11 0000 FB EE 00 00 08          		mov.L	#0x80000, r14
  12 0005 FA E9 FF 01 02 A5       		mov.W	#0xffffa502, 1022[r14]
  27:../src/peripheral/timer.cpp **** 	SYSTEM.MSTPCRA.BIT.MSTPA13 = 0;//TPU0-5 ON    //モジュールストップを解除
  13                             		.loc 1 27 0
  14 000b ED E4 04                		mov.L	16[r14], r4
  28:../src/peripheral/timer.cpp **** 	SYSTEM.PRCR.WORD = 0xA500;
  29:../src/peripheral/timer.cpp **** 
  30:../src/peripheral/timer.cpp **** 	TPUA.TSTR.BIT.CST0 = 0;
  15                             		.loc 1 30 0
  16 000e FB 3E 00 81 08          		mov.L	#0x88100, r3
  27:../src/peripheral/timer.cpp **** 	SYSTEM.MSTPCRA.BIT.MSTPA13 = 0;//TPU0-5 ON    //モジュールストップを解除
  17                             		.loc 1 27 0
  18 0013 7A D4                   		bclr #13, r4
  19 0015 E7 E4 04                		mov.L	r4, 16[r14]
  28:../src/peripheral/timer.cpp **** 	SYSTEM.PRCR.WORD = 0xA500;
  20                             		.loc 1 28 0
  21 0018 FA E9 FF 01 00 A5       		mov.W	#0xffffa500, 1022[r14]
  22                             		.loc 1 30 0
  23 001e CC 34                   		mov.B	[r3], r4
  31:../src/peripheral/timer.cpp **** 	TPU0.TCR.BIT.TPSC =2; //1:PCLK/4 2:PCLK/16
  24                             		.loc 1 31 0
  25 0020 FB EE 08 81 08          		mov.L	#0x88108, r14
  30:../src/peripheral/timer.cpp **** 	TPU0.TCR.BIT.TPSC =2; //1:PCLK/4 2:PCLK/16
  26                             		.loc 1 30 0
  27 0025 7A 04                   		bclr #0, r4
  28 0027 C3 34                   		mov.B	r4, [r3]
  29                             		.loc 1 31 0
  30 0029 CD E4 08                		mov.B	8[r14], r4
  31 002c 75 24 F8                		and #-8, r4
  32 002f 78 14                   		bset #1, r4
  33 0031 C7 E4 08                		mov.B	r4, 8[r14]
  32:../src/peripheral/timer.cpp **** 	TPU0.TCNT =0;
  34                             		.loc 1 32 0
  35 0034 F9 E5 07 00             		mov.W	#0, 14[r14]
  36 0038 02                      		rts
  37                             	.LFE0:
  39                             		.global	__Z9initCMTW0v
  41                             	__Z9initCMTW0v:
  42                             	.LFB1:
  33:../src/peripheral/timer.cpp **** 
  34:../src/peripheral/timer.cpp **** }
  35:../src/peripheral/timer.cpp **** 
  36:../src/peripheral/timer.cpp **** 
  37:../src/peripheral/timer.cpp **** 
  38:../src/peripheral/timer.cpp **** void initCMTW0(){
  43                             		.loc 1 38 0
  39:../src/peripheral/timer.cpp **** 	SYSTEM.PRCR.WORD = 0xA502;
  44                             		.loc 1 39 0
  45 0039 FB 4E 00 00 08          		mov.L	#0x80000, r4
  46 003e FA 49 FF 01 02 A5       		mov.W	#0xffffa502, 1022[r4]
  40:../src/peripheral/timer.cpp **** 		MSTP(CMTW0) = 0;        //モジュールストップを解除
  47                             		.loc 1 40 0
  48 0044 A9 43                   		mov.L	16[r4], r3
  41:../src/peripheral/timer.cpp **** 	SYSTEM.PRCR.WORD = 0xA500;
  42:../src/peripheral/timer.cpp **** 
  43:../src/peripheral/timer.cpp **** 	CMTW0.CMWSTR.BIT.STR = 0; //カウント停止
  49                             		.loc 1 43 0
  50 0046 FB EE 00 42 09          		mov.L	#0x94200, r14
  40:../src/peripheral/timer.cpp **** 		MSTP(CMTW0) = 0;        //モジュールストップを解除
  51                             		.loc 1 40 0
  52 004b 7A 13                   		bclr #1, r3
  53 004d A1 43                   		mov.L	r3, 16[r4]
  41:../src/peripheral/timer.cpp **** 	SYSTEM.PRCR.WORD = 0xA500;
  54                             		.loc 1 41 0
  55 004f FA 49 FF 01 00 A5       		mov.W	#0xffffa500, 1022[r4]
  56                             		.loc 1 43 0
  57 0055 DC E4                   		mov.W	[r14], r4
  58 0057 7A 04                   		bclr #0, r4
  59 0059 D3 E4                   		mov.W	r4, [r14]
  44:../src/peripheral/timer.cpp **** 	CMTW0.CMWCR.BIT.CKS  = 2;  //0:PCLK/8  2:PCLK/128
  60                             		.loc 1 44 0
  61 005b DD E4 02                		mov.W	4[r14], r4
  62 005e 75 24 FC                		and #-4, r4
  63 0061 78 14                   		bset #1, r4
  64 0063 D7 E4 02                		mov.W	r4, 4[r14]
  45:../src/peripheral/timer.cpp **** 	CMTW0.CMWCNT = 0;
  65                             		.loc 1 45 0
  66 0066 F9 E6 04 00             		mov.L	#0, 16[r14]
  46:../src/peripheral/timer.cpp **** 	CMTW0.CMWCR.BIT.CCLR = 1;
  67                             		.loc 1 46 0
  68 006a DD E4 02                		mov.W	4[r14], r4
  69 006d 76 24 FF 1F             		and #0x1fff, r4
  70 0071 78 D4                   		bset #13, r4
  71 0073 D7 E4 02                		mov.W	r4, 4[r14]
  47:../src/peripheral/timer.cpp **** 	CMTW0.CMWCR.BIT.CMS = 0; // 32bitカウンタ
  72                             		.loc 1 47 0
  73 0076 DD E4 02                		mov.W	4[r14], r4
  74 0079 7A 94                   		bclr #9, r4
  75 007b D7 E4 02                		mov.W	r4, 4[r14]
  48:../src/peripheral/timer.cpp **** 
  49:../src/peripheral/timer.cpp **** 	CMTW0.CMWCR.BIT.CCLR = 1; //カウンタのクリア禁止
  76                             		.loc 1 49 0
  77 007e DD E4 02                		mov.W	4[r14], r4
  78 0081 76 24 FF 1F             		and #0x1fff, r4
  79 0085 78 D4                   		bset #13, r4
  80 0087 D7 E4 02                		mov.W	r4, 4[r14]
  50:../src/peripheral/timer.cpp **** 
  51:../src/peripheral/timer.cpp **** 	CMTW0.CMWSTR.BIT.STR = 1; //カウント開始
  81                             		.loc 1 51 0
  82 008a DC E4                   		mov.W	[r14], r4
  83 008c 78 04                   		bset #0, r4
  84 008e D3 E4                   		mov.W	r4, [r14]
  85 0090 02                      		rts
  86                             	.LFE1:
  88                             		.global	__Z9initCMTW1v
  90                             	__Z9initCMTW1v:
  91                             	.LFB2:
  52:../src/peripheral/timer.cpp **** }
  53:../src/peripheral/timer.cpp **** 
  54:../src/peripheral/timer.cpp **** void initCMTW1(){
  92                             		.loc 1 54 0
  55:../src/peripheral/timer.cpp **** 	SYSTEM.PRCR.WORD = 0xA502;
  93                             		.loc 1 55 0
  94 0091 FB 4E 00 00 08          		mov.L	#0x80000, r4
  95 0096 FA 49 FF 01 02 A5       		mov.W	#0xffffa502, 1022[r4]
  56:../src/peripheral/timer.cpp **** 		MSTP(CMTW1)  = 0;        //モジュールストップを解除
  96                             		.loc 1 56 0
  97 009c A9 43                   		mov.L	16[r4], r3
  57:../src/peripheral/timer.cpp **** 	SYSTEM.PRCR.WORD = 0xA500;
  58:../src/peripheral/timer.cpp **** 
  59:../src/peripheral/timer.cpp **** 	CMTW1.CMWCR.BIT.CKS  = 0;  //0:PCLK/8  2:PCLK/128
  98                             		.loc 1 59 0
  99 009e FB EE 80 42 09          		mov.L	#0x94280, r14
  56:../src/peripheral/timer.cpp **** 		MSTP(CMTW1)  = 0;        //モジュールストップを解除
 100                             		.loc 1 56 0
 101 00a3 7A 03                   		bclr #0, r3
 102 00a5 A1 43                   		mov.L	r3, 16[r4]
  57:../src/peripheral/timer.cpp **** 	SYSTEM.PRCR.WORD = 0xA500;
 103                             		.loc 1 57 0
 104 00a7 FA 49 FF 01 00 A5       		mov.W	#0xffffa500, 1022[r4]
 105                             		.loc 1 59 0
 106 00ad DD E4 02                		mov.W	4[r14], r4
 107 00b0 75 24 FC                		and #-4, r4
 108 00b3 D7 E4 02                		mov.W	r4, 4[r14]
  60:../src/peripheral/timer.cpp **** 	CMTW1.CMWCNT = 0;
 109                             		.loc 1 60 0
 110 00b6 F9 E6 04 00             		mov.L	#0, 16[r14]
  61:../src/peripheral/timer.cpp **** 	CMTW1.CMWCR.BIT.CCLR = 1;
 111                             		.loc 1 61 0
 112 00ba DD E4 02                		mov.W	4[r14], r4
 113 00bd 76 24 FF 1F             		and #0x1fff, r4
 114 00c1 78 D4                   		bset #13, r4
 115 00c3 D7 E4 02                		mov.W	r4, 4[r14]
  62:../src/peripheral/timer.cpp **** 	CMTW1.CMWCR.BIT.CMS = 0; // 32bitカウンタ
 116                             		.loc 1 62 0
 117 00c6 DD E4 02                		mov.W	4[r14], r4
 118 00c9 7A 94                   		bclr #9, r4
 119 00cb D7 E4 02                		mov.W	r4, 4[r14]
  63:../src/peripheral/timer.cpp **** 
  64:../src/peripheral/timer.cpp **** 	CMTW1.CMWCR.BIT.CCLR = 1; //カウンタのクリア禁止
 120                             		.loc 1 64 0
 121 00ce DD E4 02                		mov.W	4[r14], r4
 122 00d1 76 24 FF 1F             		and #0x1fff, r4
 123 00d5 78 D4                   		bset #13, r4
 124 00d7 D7 E4 02                		mov.W	r4, 4[r14]
  65:../src/peripheral/timer.cpp **** 	CMTW1.CMWCNT = 0;
 125                             		.loc 1 65 0
 126 00da F9 E6 04 00             		mov.L	#0, 16[r14]
 127 00de 02                      		rts
 128                             	.LFE2:
 130                             		.global	__Z14waitClockCountm
 132                             	__Z14waitClockCountm:
 133                             	.LFB3:
  66:../src/peripheral/timer.cpp **** }
  67:../src/peripheral/timer.cpp **** 
  68:../src/peripheral/timer.cpp **** void waitClockCount(uint32_t cCount){
 134                             		.loc 1 68 0
 135                             	.LVL0:
  69:../src/peripheral/timer.cpp **** 	//PCLKBでカウント;
  70:../src/peripheral/timer.cpp **** 	//count_clock = PCLKB/8;
  71:../src/peripheral/timer.cpp **** 	CMTW1.CMWCNT = 0;  //カウント値を0にする
 136                             		.loc 1 71 0
 137 00df FB 3E 80 42 09          		mov.L	#0x94280, r3
 138 00e4 3E 34 00                		mov.L	#0, 16[r3]
  72:../src/peripheral/timer.cpp **** 	CMTW1.CMWSTR.BIT.STR = 1; //カウント開始
 139                             		.loc 1 72 0
 140 00e7 DC 3E                   		mov.W	[r3], r14
 141 00e9 78 0E                   		bset #0, r14
 142 00eb D3 3E                   		mov.W	r14, [r3]
 143                             		.balign 8,3,1
 144                             	.L6:
  73:../src/peripheral/timer.cpp **** 
  74:../src/peripheral/timer.cpp **** 	while(1){
  75:../src/peripheral/timer.cpp **** 		if( CMTW1.CMWCNT >= cCount) break;
 145                             		.loc 1 75 0
 146 00ed ED 3E 04                		mov.L	16[r3], r14
 147 00f0 FB 4E 80 42 09          		mov.L	#0x94280, r4
 148 00f5 47 1E                   		cmp	r1, r14
 149 00f7 23 F6                   		bltu	.L6
  76:../src/peripheral/timer.cpp **** 	}
  77:../src/peripheral/timer.cpp **** 	CMTW1.CMWSTR.BIT.STR = 0; //カウント停止
 150                             		.loc 1 77 0
 151 00f9 DC 4E                   		mov.W	[r4], r14
 152 00fb 7A 0E                   		bclr #0, r14
 153 00fd D3 4E                   		mov.W	r14, [r4]
 154 00ff 02                      		rts
 155                             	.LFE3:
 157                             		.global	__Z8waitusecm
 159                             	__Z8waitusecm:
 160                             	.LFB4:
  78:../src/peripheral/timer.cpp **** 
  79:../src/peripheral/timer.cpp **** }
  80:../src/peripheral/timer.cpp **** 
  81:../src/peripheral/timer.cpp **** 
  82:../src/peripheral/timer.cpp **** 
  83:../src/peripheral/timer.cpp **** void waitusec(uint32_t usec){
 161                             		.loc 1 83 0
 162                             	.LVL1:
  84:../src/peripheral/timer.cpp **** 	//PCLKBでカウント;
  85:../src/peripheral/timer.cpp **** 	//count_clock = PCLKB/8;
  86:../src/peripheral/timer.cpp **** 	CMTW1.CMWCNT = 0;  //カウント値を0にする
 163                             		.loc 1 86 0
 164 0100 FB 3E 80 42 09          		mov.L	#0x94280, r3
 165 0105 3E 34 00                		mov.L	#0, 16[r3]
  87:../src/peripheral/timer.cpp **** 	CMTW1.CMWSTR.BIT.STR = 1; //カウント開始
 166                             		.loc 1 87 0
 167 0108 DC 3E                   		mov.W	[r3], r14
 168 010a 63 61                   		mul	#6, r1
 169                             	.LVL2:
 170 010c 78 0E                   		bset #0, r14
 171 010e D3 3E                   		mov.W	r14, [r3]
 172                             		.balign 8,3,1
 173                             	.L10:
  88:../src/peripheral/timer.cpp **** 
  89:../src/peripheral/timer.cpp **** 	while(1){
  90:../src/peripheral/timer.cpp **** 		if( CMTW1.CMWCNT >= u_count * usec) break;
 174                             		.loc 1 90 0
 175 0110 ED 3E 04                		mov.L	16[r3], r14
 176 0113 FB 4E 80 42 09          		mov.L	#0x94280, r4
 177 0118 47 1E                   		cmp	r1, r14
 178 011a 23 F6                   		bltu	.L10
  91:../src/peripheral/timer.cpp **** 	}
  92:../src/peripheral/timer.cpp **** 	CMTW1.CMWSTR.BIT.STR = 0; //カウント停止
 179                             		.loc 1 92 0
 180 011c DC 4E                   		mov.W	[r4], r14
 181 011e 7A 0E                   		bclr #0, r14
 182 0120 D3 4E                   		mov.W	r14, [r4]
 183 0122 02                      		rts
 184                             	.LFE4:
 186                             		.global	__Z8waitmsecm
 188                             	__Z8waitmsecm:
 189                             	.LFB5:
  93:../src/peripheral/timer.cpp **** }
  94:../src/peripheral/timer.cpp **** 
  95:../src/peripheral/timer.cpp **** void waitmsec(uint32_t msec){
 190                             		.loc 1 95 0
 191                             	.LVL3:
  96:../src/peripheral/timer.cpp **** 	//PCLKBでカウント;
  97:../src/peripheral/timer.cpp **** 	//count_clock = PCLKB/8;
  98:../src/peripheral/timer.cpp **** 	CMTW1.CMWCNT = 0;  // 32bitカウント値を0にする
 192                             		.loc 1 98 0
 193 0123 FB 3E 80 42 09          		mov.L	#0x94280, r3
 194 0128 3E 34 00                		mov.L	#0, 16[r3]
  99:../src/peripheral/timer.cpp **** 	CMTW1.CMWSTR.BIT.STR = 1; //カウント開始
 195                             		.loc 1 99 0
 196 012b DC 3E                   		mov.W	[r3], r14
 197 012d 76 11 70 17             		mul	#0x1770, r1
 198                             	.LVL4:
 199 0131 78 0E                   		bset #0, r14
 200 0133 D3 3E                   		mov.W	r14, [r3]
 201                             		.balign 8,3,1
 202                             	.L13:
 100:../src/peripheral/timer.cpp **** 
 101:../src/peripheral/timer.cpp **** 	while(1){
 102:../src/peripheral/timer.cpp **** 		if( CMTW1.CMWCNT >= m_count * msec) break;
 203                             		.loc 1 102 0
 204 0135 ED 3E 04                		mov.L	16[r3], r14
 205 0138 FB 4E 80 42 09          		mov.L	#0x94280, r4
 206 013d 47 1E                   		cmp	r1, r14
 207 013f 23 F6                   		bltu	.L13
 103:../src/peripheral/timer.cpp **** 	}
 104:../src/peripheral/timer.cpp **** 	CMTW1.CMWSTR.BIT.STR = 0; //カウント停止
 208                             		.loc 1 104 0
 209 0141 DC 4E                   		mov.W	[r4], r14
 210 0143 7A 0E                   		bclr #0, r14
 211 0145 D3 4E                   		mov.W	r14, [r4]
 212 0147 02                      		rts
 213                             	.LFE5:
 215                             		.global	__Z15startTimeuCountv
 217                             	__Z15startTimeuCountv:
 218                             	.LFB6:
 105:../src/peripheral/timer.cpp **** }
 106:../src/peripheral/timer.cpp **** 
 107:../src/peripheral/timer.cpp **** void startTimeuCount(){
 219                             		.loc 1 107 0
 108:../src/peripheral/timer.cpp **** 	CMTW1.CMWCNT = 0;  //カウント値を0にする
 220                             		.loc 1 108 0
 221 0148 FB EE 80 42 09          		mov.L	#0x94280, r14
 222 014d F9 E6 04 00             		mov.L	#0, 16[r14]
 109:../src/peripheral/timer.cpp **** 	CMTW1.CMWSTR.BIT.STR = 1; //カウント開始
 223                             		.loc 1 109 0
 224 0151 DC E4                   		mov.W	[r14], r4
 225 0153 78 04                   		bset #0, r4
 226 0155 D3 E4                   		mov.W	r4, [r14]
 227 0157 02                      		rts
 228                             	.LFE6:
 230                             		.global	__Z13getTimeuCountv
 232                             	__Z13getTimeuCountv:
 233                             	.LFB7:
 110:../src/peripheral/timer.cpp **** };
 111:../src/peripheral/timer.cpp **** 
 112:../src/peripheral/timer.cpp **** unsigned int getTimeuCount(void){
 234                             		.loc 1 112 0
 113:../src/peripheral/timer.cpp **** 	return CMTW1.CMWCNT/u_count;
 235                             		.loc 1 113 0
 236 0158 FB EE 80 42 09          		mov.L	#0x94280, r14
 237 015d ED E4 04                		mov.L	16[r14], r4
 238 0160 FB E2 AB AA AA AA       		mov.L	#0xaaaaaaab, r14
 239 0166 FC 1F 4E                		emulu	r4, r14
 114:../src/peripheral/timer.cpp **** }
 240                             		.loc 1 114 0
 241 0169 FD 82 F1                		shlr	#2, r15, r1
 242 016c 02                      		rts
 243                             	.LFE7:
 245                             		.global	__Z13endTimeuCountv
 247                             	__Z13endTimeuCountv:
 248                             	.LFB8:
 115:../src/peripheral/timer.cpp **** 
 116:../src/peripheral/timer.cpp **** 
 117:../src/peripheral/timer.cpp **** unsigned int endTimeuCount(){
 249                             		.loc 1 117 0
 118:../src/peripheral/timer.cpp **** 	CMTW1.CMWSTR.BIT.STR = 0; //カウント停止
 250                             		.loc 1 118 0
 251 016d FB EE 80 42 09          		mov.L	#0x94280, r14
 252 0172 DC E4                   		mov.W	[r14], r4
 253 0174 7A 04                   		bclr #0, r4
 254 0176 D3 E4                   		mov.W	r4, [r14]
 119:../src/peripheral/timer.cpp **** 	return CMTW1.CMWCNT/u_count;
 255                             		.loc 1 119 0
 256 0178 ED E4 04                		mov.L	16[r14], r4
 257 017b FB E2 AB AA AA AA       		mov.L	#0xaaaaaaab, r14
 258 0181 FC 1F 4E                		emulu	r4, r14
 120:../src/peripheral/timer.cpp **** }
 259                             		.loc 1 120 0
 260 0184 FD 82 F1                		shlr	#2, r15, r1
 261 0187 02                      		rts
 262                             	.LFE8:
 264                             		.global	__Z18waitClockCount_subm
 266                             	__Z18waitClockCount_subm:
 267                             	.LFB9:
 121:../src/peripheral/timer.cpp **** 
 122:../src/peripheral/timer.cpp **** 
 123:../src/peripheral/timer.cpp **** 
 124:../src/peripheral/timer.cpp **** void waitClockCount_sub(uint32_t cCount){
 268                             		.loc 1 124 0
 269                             	.LVL5:
 125:../src/peripheral/timer.cpp **** 	TPU0.TCNT = 0; //カウント値を0にする
 270                             		.loc 1 125 0
 271 0188 FB 4E 08 81 08          		mov.L	#0x88108, r4
 272 018d 3D 47 00                		mov.W	#0, 14[r4]
 126:../src/peripheral/timer.cpp **** 	TPUA.TSTR.BIT.CST0 = 1; //カウント開始
 273                             		.loc 1 126 0
 274 0190 FB EE 00 81 08          		mov.L	#0x88100, r14
 275 0195 F0 E0                   		bset #0, [r14].B
 276 0197 03                      		.balign 8,3,3
 277                             	.L19:
 127:../src/peripheral/timer.cpp **** 
 128:../src/peripheral/timer.cpp **** 	while(1){
 129:../src/peripheral/timer.cpp **** 		if( TPU0.TCNT >= cCount) break;
 278                             		.loc 1 129 0
 279 0198 5D 4E 07                		movu.W	14[r4], r14
 280 019b 47 1E                   		cmp	r1, r14
 281 019d 23 FB                   		bltu	.L19
 130:../src/peripheral/timer.cpp **** 	}
 131:../src/peripheral/timer.cpp **** 	TPUA.TSTR.BIT.CST0 = 0;//カウント停止
 282                             		.loc 1 131 0
 283 019f FB EE 00 81 08          		mov.L	#0x88100, r14
 284 01a4 F0 E8                   		bclr #0, [r14].B
 285 01a6 02                      		rts
 286                             	.LFE9:
 288                             		.global	__Z12waitusec_subm
 290                             	__Z12waitusec_subm:
 291                             	.LFB10:
 132:../src/peripheral/timer.cpp **** }
 133:../src/peripheral/timer.cpp **** 
 134:../src/peripheral/timer.cpp **** void waitusec_sub(uint32_t usec){
 292                             		.loc 1 134 0
 293                             	.LVL6:
 135:../src/peripheral/timer.cpp **** 	//PCLKBでカウント;
 136:../src/peripheral/timer.cpp **** 	//count_clock = PCLKB/16;
 137:../src/peripheral/timer.cpp **** 
 138:../src/peripheral/timer.cpp **** 
 139:../src/peripheral/timer.cpp **** 	TPU0.TCNT =0;
 294                             		.loc 1 139 0
 295 01a7 FB 4E 08 81 08          		mov.L	#0x88108, r4
 296 01ac 3D 47 00                		mov.W	#0, 14[r4]
 140:../src/peripheral/timer.cpp **** 	TPUA.TSTR.BIT.CST0 = 1;
 297                             		.loc 1 140 0
 298 01af FB EE 00 81 08          		mov.L	#0x88100, r14
 299 01b4 CC E3                   		mov.B	[r14], r3
 300 01b6 63 31                   		mul	#3, r1
 301                             	.LVL7:
 302 01b8 78 03                   		bset #0, r3
 303 01ba C3 E3                   		mov.B	r3, [r14]
 304                             		.balign 8,3,3
 305                             	.L22:
 141:../src/peripheral/timer.cpp **** 
 142:../src/peripheral/timer.cpp **** 	while(1){
 143:../src/peripheral/timer.cpp **** 		if( TPU0.TCNT >= 3 * usec) break;
 306                             		.loc 1 143 0
 307 01bc 5D 4E 07                		movu.W	14[r4], r14
 308 01bf 47 1E                   		cmp	r1, r14
 309 01c1 23 FB                   		bltu	.L22
 144:../src/peripheral/timer.cpp **** 	}
 145:../src/peripheral/timer.cpp **** 	TPUA.TSTR.BIT.CST0 = 0; //カウント停止
 310                             		.loc 1 145 0
 311 01c3 FB EE 00 81 08          		mov.L	#0x88100, r14
 312 01c8 F0 E8                   		bclr #0, [r14].B
 313 01ca 02                      		rts
 314                             	.LFE10:
 316                             		.global	__Z12waitmsec_subm
 318                             	__Z12waitmsec_subm:
 319                             	.LFB11:
 146:../src/peripheral/timer.cpp **** }
 147:../src/peripheral/timer.cpp **** 
 148:../src/peripheral/timer.cpp **** void waitmsec_sub(uint32_t msec){
 320                             		.loc 1 148 0
 321                             	.LVL8:
 149:../src/peripheral/timer.cpp **** 	//PCLKBでカウント;
 150:../src/peripheral/timer.cpp **** 	//count_clock = PCLKB/8;
 151:../src/peripheral/timer.cpp **** 	TPU0.TCNT =0;
 322                             		.loc 1 151 0
 323 01cb FB 4E 08 81 08          		mov.L	#0x88108, r4
 324 01d0 3D 47 00                		mov.W	#0, 14[r4]
 152:../src/peripheral/timer.cpp **** 	TPUA.TSTR.BIT.CST0 = 1;
 325                             		.loc 1 152 0
 326 01d3 FB EE 00 81 08          		mov.L	#0x88100, r14
 327 01d8 CC E3                   		mov.B	[r14], r3
 328 01da 76 11 B8 0B             		mul	#0xbb8, r1
 329                             	.LVL9:
 330 01de 78 03                   		bset #0, r3
 331 01e0 C3 E3                   		mov.B	r3, [r14]
 332                             		.balign 8,3,3
 333                             	.L25:
 153:../src/peripheral/timer.cpp **** 
 154:../src/peripheral/timer.cpp **** 
 155:../src/peripheral/timer.cpp **** 	while(1){
 156:../src/peripheral/timer.cpp **** 		if( TPU0.TCNT >= 3000 * msec) break;
 334                             		.loc 1 156 0
 335 01e2 5D 4E 07                		movu.W	14[r4], r14
 336 01e5 47 1E                   		cmp	r1, r14
 337 01e7 23 FB                   		bltu	.L25
 157:../src/peripheral/timer.cpp **** 	}
 158:../src/peripheral/timer.cpp **** 	TPUA.TSTR.BIT.CST0 = 0; //カウント停止
 338                             		.loc 1 158 0
 339 01e9 FB EE 00 81 08          		mov.L	#0x88100, r14
 340 01ee F0 E8                   		bclr #0, [r14].B
 341 01f0 02                      		rts
 342                             	.LFE11:
 344                             		.global	__Z19startTimeuCount_subv
 346                             	__Z19startTimeuCount_subv:
 347                             	.LFB12:
 159:../src/peripheral/timer.cpp **** }
 160:../src/peripheral/timer.cpp **** 
 161:../src/peripheral/timer.cpp **** void startTimeuCount_sub(){
 348                             		.loc 1 161 0
 162:../src/peripheral/timer.cpp **** 	TPU0.TCNT = 0; //カウント値を0にする
 349                             		.loc 1 162 0
 350 01f1 FB EE 08 81 08          		mov.L	#0x88108, r14
 351 01f6 F9 E5 07 00             		mov.W	#0, 14[r14]
 163:../src/peripheral/timer.cpp **** 	TPUA.TSTR.BIT.CST0=1; //カウント開始
 352                             		.loc 1 163 0
 353 01fa FB EE 00 81 08          		mov.L	#0x88100, r14
 354 01ff F0 E0                   		bset #0, [r14].B
 355 0201 02                      		rts
 356                             	.LFE12:
 358                             		.global	__Z17getTimeuCount_subv
 360                             	__Z17getTimeuCount_subv:
 361                             	.LFB13:
 164:../src/peripheral/timer.cpp **** };
 165:../src/peripheral/timer.cpp **** 
 166:../src/peripheral/timer.cpp **** unsigned int getTimeuCount_sub(void){
 362                             		.loc 1 166 0
 167:../src/peripheral/timer.cpp **** 	return TPU0.TCNT/3;
 363                             		.loc 1 167 0
 364 0202 FB EE 08 81 08          		mov.L	#0x88108, r14
 365 0207 5D EE 07                		movu.W	14[r14], r14
 366 020a FB 42 AB AA AA AA       		mov.L	#0xaaaaaaab, r4
 367 0210 FC 1F 4E                		emulu	r4, r14
 368 0213 FD 81 F1                		shlr	#1, r15, r1
 168:../src/peripheral/timer.cpp **** }
 369                             		.loc 1 168 0
 370 0216 5F 11                   		movu.W	r1, r1
 371 0218 02                      		rts
 372                             	.LFE13:
 374                             		.global	__Z17endTimeuCount_subv
 376                             	__Z17endTimeuCount_subv:
 377                             	.LFB14:
 169:../src/peripheral/timer.cpp **** 
 170:../src/peripheral/timer.cpp **** unsigned int endTimeuCount_sub(){
 378                             		.loc 1 170 0
 171:../src/peripheral/timer.cpp **** 	TPUA.TSTR.BIT.CST0; //カウント停止
 379                             		.loc 1 171 0
 380 0219 FB EE 00 81 08          		mov.L	#0x88100, r14
 381 021e CC E4                   		mov.B	[r14], r4
 172:../src/peripheral/timer.cpp **** 	return TPUA.TSTR.BIT.CST0/3;
 173:../src/peripheral/timer.cpp **** };
 382                             		.loc 1 173 0
 383 0220 66 01                   		mov.L	#0, r1
 172:../src/peripheral/timer.cpp **** 	return TPUA.TSTR.BIT.CST0/3;
 384                             		.loc 1 172 0
 385 0222 CC EE                   		mov.B	[r14], r14
 386                             		.loc 1 173 0
 387 0224 02                      		rts
 388                             	.LFE14:
 390                             		.global	__Z14getElapsedMsecv
 392                             	__Z14getElapsedMsecv:
 393                             	.LFB15:
 174:../src/peripheral/timer.cpp **** 
 175:../src/peripheral/timer.cpp **** unsigned int getElapsedMsec(){
 394                             		.loc 1 175 0
 176:../src/peripheral/timer.cpp **** 	//48MHz,128分周 -> 375カウントで1msec
 177:../src/peripheral/timer.cpp **** 	//190分くらいまでしか計れない
 178:../src/peripheral/timer.cpp **** 	return CMTW0.CMWCNT/375;
 395                             		.loc 1 178 0
 396 0225 FB EE 00 42 09          		mov.L	#0x94200, r14
 397 022a ED E4 04                		mov.L	16[r14], r4
 398 022d FB E2 F1 19 76 05       		mov.L	#0x57619f1, r14
 399 0233 FC 1F 4E                		emulu	r4, r14
 179:../src/peripheral/timer.cpp **** };
 400                             		.loc 1 179 0
 401 0236 FD 83 F1                		shlr	#3, r15, r1
 402 0239 02                      		rts
 403                             	.LFE15:
 551                             	.Letext0:
 552                             		.file 2 "c:\\progra~2\\gccfor~2.201\\rx-elf\\rx-elf\\rx-elf\\include\\machine\\_default_types.h"
 553                             		.file 3 "c:\\progra~2\\gccfor~2.201\\rx-elf\\rx-elf\\rx-elf\\include\\stdint.h"
 554                             		.file 4 "../src/peripheral/iodefine.h"
 555                             		.file 5 "../src/peripheral/clock.h"
